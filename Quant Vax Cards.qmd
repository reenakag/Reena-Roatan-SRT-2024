---
title: "Quant Vax Cards"
format: html
---

```{r}
library(tidyverse)
library(lubridate)
library(readxl)
library(googlesheets4)
library(broom)
```


```{r}
library(readr)
QUANT_vax_cards <- read_csv("QUANT_vax_cards.csv", 
    col_types = cols(date = col_date(format = "%d-%m-%y")))
View(QUANT_vax_cards)
```

```{r}
#| label: gender

# frequency table
QUANT_vax_cards |>
  count(gender) |>
  mutate(prop = n/sum(n))

# bar chart
QUANT_vax_cards |> ggplot(
  aes(x = gender, fill = gender)
) +
  geom_bar() +
  labs(title = "Genders of Children Accounted For", subtitle = "with Vaccine Cards")

# pie chart
slices <- c(122, 132, 16)
labels <- c("Female", "Male", "Unknown")
percent <- round(slices/sum(slices)*100)
labels <- paste(labels, percent)
labels <- paste(labels,"%",sep="") 
pie(slices, labels = labels, col = rainbow(length(labels)), main = "Pie Chart of Genders Survyed (with Vaccine Cards)")
  
```

```{r}
#| label: date format

dob_date_format_tibble <- QUANT_vax_cards |>
  select(dob, dob_date_format) |>
  mutate(day = day(dob_date_format),
         month = month(dob_date_format),
         year = year(dob_date_format))

dob_date_format_tibble
```

```{r}
#| label: adding-vax-score

vax_score_tibble <- QUANT_vax_cards |>
  select(dob, dob_date_format) |>
  mutate(dob_day = day(dob_date_format),
         dob_month = month(dob_date_format),
         dob_year = year(dob_date_format))

today = Sys.Date()

vax_score_tibble <- vax_score_tibble |>
  mutate(age_in_days = today - dob_date_format) |>
  mutate(age_in_years = as.numeric(age_in_days) / 365.25) |>
  mutate(age_rounded = round(age_in_years, 1))

vax_score_tibble

 # ,
   #      age_months = months(today_month) - month,
   #      age_year = years(today_year) - year)
```

